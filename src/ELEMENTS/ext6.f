CDOC BEGIN_SUBROUTINE EXT6
CDOC Gauss point-node extrapolation matrix for element type TRI6
CDOC
CDOC This routine sets the coefficients matrix for extrapolation of
CDOC fields from Gauss point values to nodal values for element type
CDOC TRI6: Standard isoparametric 6-noded quadratic triangle.
CDOC
CDOC BEGIN_PARAMETERS
CDOC DOUBLE_PRECISION EXMATX <  Extrapolation matrix.
CDOC END_PARAMETERS
CHST
CHST
CHST
      SUBROUTINE EXT6
     1(   NGAUSP     ,EXMATX     )
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER(NNODE=6)
      DIMENSION EXMATX(NNODE,NGAUSP)
      DOUBLE PRECISION, PARAMETER :: R3=3.0D0     , R1D3=1.0D0/R3, 
     1                               R2D3=2.0D0/R3, R5D3=5.0D0/R3
      
      DATA R1    /
     1     1.0D0 /
      DATA
     1    A6                 ,B6                 ,C6               ,
     2    D6                 ,E6                 ,F6               ,
     3    G6                 ,H6                 /
     4    0.1385595874119D0  ,1.8736592735116D0 ,-0.6385595874119D0,
     5    0.1263407264884D0  ,0.0749010751157D0  ,0.1800530807345D0,
     6   -0.3451857826368D0  ,1.3605163343076D0  /
      
C***********************************************************************
C SET COEFFICIENTS MATRIX (EXMATX) FOR EXTRAPOLATION FROM GAUSS POINTS
C TO NODES FOR ELEMENT TYPE 'TRI_6' (STANDARD 6-NODED QUADRATIC
C TRIANGLE)
C
C REFERENCE: Section 5.6.1
C            E Hinton & JS Campbel. Local and global Smoothing of
C            discontinuous finite element functions using a least
C            squares method. Int. J. Num. meth. Engng., 8:461-480, 1974.
C            E Hinton & DRJ Owen. An introduction to finite element
C            computations. Pineridge Press, Swansea, 1979.
C***********************************************************************
      IF(NGAUSP.EQ.1)THEN
        EXMATX(1,1)=R1
        EXMATX(2,1)=R1
        EXMATX(3,1)=R1
        EXMATX(4,1)=R1
        EXMATX(5,1)=R1
        EXMATX(6,1)=R1
      ELSEIF(NGAUSP.EQ.3)THEN
        EXMATX(1,1)=R5D3
        EXMATX(1,2)=-R1D3
        EXMATX(1,3)=-R1D3
        EXMATX(2,1)=R2D3
        EXMATX(2,2)=R2D3
        EXMATX(2,3)=-R1D3
        EXMATX(3,1)=-R1D3
        EXMATX(3,2)=R5D3
        EXMATX(3,3)=-R1D3
        EXMATX(4,1)=-R1D3
        EXMATX(4,2)=R2D3
        EXMATX(4,3)=R2D3
        EXMATX(5,1)=-R1D3
        EXMATX(5,2)=-R1D3
        EXMATX(5,3)=R5D3
        EXMATX(6,1)=R2D3
        EXMATX(6,2)=-R1D3
        EXMATX(6,3)=R2D3
      ELSEIF(NGAUSP.EQ.6)THEN
        EXMATX(1,1)=0.13855958741193590D0
        EXMATX(1,2)=0.13855958741193600D0
        EXMATX(1,3)=1.87365927351160800D0
        EXMATX(1,4)=-0.63855958741193750D0
        EXMATX(1,5)=-0.63855958741193670D0
        EXMATX(1,6)=0.12634072648839450D0
        EXMATX(2,1)=0.07490107511574406D0
        EXMATX(2,2)=0.18005308073447750D0
        EXMATX(2,3)=0.07490107511574450D0
        EXMATX(2,4)=-0.34518578263679060D0
        EXMATX(2,5)=1.36051633430761500D0
        EXMATX(2,6)=-0.34518578263679070D0
        EXMATX(3,1)=1.87365927351160100D0
        EXMATX(3,2)=0.13855958741193760D0
        EXMATX(3,3)=0.13855958741193540D0
        EXMATX(3,4)=0.12634072648839320D0
        EXMATX(3,5)=-0.63855958741192880D0
        EXMATX(3,6)=-0.63855958741193850D0
        EXMATX(4,1)=0.07490107511574406D0
        EXMATX(4,2)=0.07490107511574362D0
        EXMATX(4,3)=0.18005308073447820D0
        EXMATX(4,4)=-0.34518578263679170D0
        EXMATX(4,5)=-0.34518578263679030D0
        EXMATX(4,6)=1.36051633430761600D0
        EXMATX(5,1)=0.13855958741193590D0
        EXMATX(5,2)=1.87365927351160100D0
        EXMATX(5,3)=0.13855958741193450D0
        EXMATX(5,4)=-0.63855958741193050D0
        EXMATX(5,5)=0.12634072648839740D0
        EXMATX(5,6)=-0.63855958741193870D0
        EXMATX(6,1)=0.18005308073447760D0
        EXMATX(6,2)=0.07490107511574351D0
        EXMATX(6,3)=0.07490107511574474D0
        EXMATX(6,4)=1.36051633430761500D0
        EXMATX(6,5)=-0.34518578263679010D0
        EXMATX(6,6)=-0.34518578263679070D0
      ELSEIF(NGAUSP.EQ.7)THEN
        EXMATX(1,1)=-0.692307692307689D0
        EXMATX(1,2)=0.143444958189250D0
        EXMATX(1,3)=0.143444958189250D0
        EXMATX(1,4)=1.974392460120358D0
        EXMATX(1,5)=0.256376770648867D0
        EXMATX(1,6)=-0.412675727420018D0
        EXMATX(1,7)=-0.412675727420018D0
        EXMATX(2,1)=0.177514792899408D0
        EXMATX(2,2)=0.098125809310779D0
        EXMATX(2,3)=0.156266015552074D0
        EXMATX(2,4)=0.098125809310779D0
        EXMATX(2,5)=-0.282297406943915D0
        EXMATX(2,6)=-0.282297406943916D0
        EXMATX(2,7)=1.034562386814791D0
        EXMATX(3,1)=-0.692307692307694D0
        EXMATX(3,2)=1.974392460120366D0
        EXMATX(3,3)=0.143444958189250D0
        EXMATX(3,4)=0.143444958189252D0
        EXMATX(3,5)=-0.412675727420016D0
        EXMATX(3,6)=0.256376770648868D0
        EXMATX(3,7)=-0.412675727420026D0
        EXMATX(4,1)=0.177514792899408D0
        EXMATX(4,2)=0.098125809310778D0
        EXMATX(4,3)=0.098125809310778D0
        EXMATX(4,4)=0.156266015552073D0
        EXMATX(4,5)=1.034562386814791D0
        EXMATX(4,6)=-0.282297406943915D0
        EXMATX(4,7)=-0.282297406943915D0
        EXMATX(5,1)=-0.692307692307693D0
        EXMATX(5,2)=0.143444958189250D0
        EXMATX(5,3)=1.974392460120366D0
        EXMATX(5,4)=0.143444958189252D0
        EXMATX(5,5)=-0.412675727420016D0
        EXMATX(5,6)=-0.412675727420026D0
        EXMATX(5,7)=0.256376770648868D0
        EXMATX(6,1)=0.177514792899408D0
        EXMATX(6,2)=0.156266015552074D0
        EXMATX(6,3)=0.098125809310778D0
        EXMATX(6,4)=0.098125809310778D0
        EXMATX(6,5)=-0.282297406943914D0
        EXMATX(6,6)=1.034562386814791D0
        EXMATX(6,7)=-0.282297406943915D0
      ENDIF
C
      RETURN
      END
CDOC END_SUBROUTINE EXT6
